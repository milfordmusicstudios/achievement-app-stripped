<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Review Logs | Achievement App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body class="tall-background">
  <main class="app">

    <!-- ✅ Top Bar -->
    <header id="pageHeader">
      <button class="blue-button" onclick="window.location.href='index.html'">Home</button>
      <h2>Review Logs</h2>
    </header>
<!-- Notifications toggle -->
<div style="text-align:center; margin-bottom:15px;">
  <button id="showLogsBtn" class="blue-button">Show Logs</button>
  <button id="showNotificationsBtn" class="blue-button">Show Notifications</button>
</div>

<!-- Notifications Section -->
<div id="notificationsSection" style="display:none; padding:20px;"></div>

    <!-- ✅ Category Summary -->
    <section id="categorySummary"></section>

    <!-- ✅ Action Bar -->
    <div id="actionBar">
      <input id="searchInput" type="text" placeholder="Search logs...">
      <select id="statusFilter" class="blue-button">
        <option value="">All Statuses</option>
        <option value="pending">Pending</option>
        <option value="approved">Approved</option>
        <option value="rejected">Rejected</option>
        <option value="needs info">Needs Info</option>
      </select>
      <button id="quickAddBtn" class="blue-button">Quick Add</button>
      <button id="bulkApproveBtn" class="blue-button">Approve Selected</button>
      <button id="deleteSelectedBtn" class="blue-button" style="background:#d9534f;">Delete Selected</button>
    </div>

    <!-- ✅ Bulk Approve Panel -->
    <div id="bulkApprovePanel" style="display:none; text-align:center; margin-bottom:10px;">
      <label>Points to assign:
        <input type="number" id="bulkPoints" style="width:80px;">
      </label>
      <button id="confirmBulkApprove" class="blue-button">Confirm</button>
      <button id="cancelBulkApprove" class="blue-button" style="background:#999;">Cancel</button>
    </div>

    <!-- ✅ Scrollable Table -->
    <div id="logsWrapper">
      <table id="logsHeaderTable">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAll"></th>
            <th data-sort="fullName">Student</th>
            <th data-sort="category">Category</th>
            <th data-sort="date">Date</th>
            <th data-sort="points">Points</th>
            <th>Note</th>
            <th data-sort="status">Status</th>
          </tr>
        </thead>
      </table>

      <table id="logsTable">
        <tbody id="logsTableBody"></tbody>
      </table>
    </div>

    <!-- ✅ Pagination -->
    <div id="paginationControls">
      <button id="prevPageBtn" class="blue-button">Prev</button>
      <span id="pageInfo"></span>
      <button id="nextPageBtn" class="blue-button">Next</button>
      <select id="logsPerPage" class="blue-button">
        <option value="25">25</option>
        <option value="50" selected>50</option>
        <option value="100">100</option>
      </select>
    </div>
<!-- ✅ Quick Add Modal -->
<div id="quickAddModal" class="modal" style="display:none;
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.6); z-index:10000; justify-content:center; align-items:center;">
  <div class="modal-content" style="background:white; padding:20px; border-radius:10px; width:90%; max-width:500px;">
    <h3 style="text-align:center; color:#00477d;">Quick Add Points</h3>
    <div style="max-height:400px; overflow:visible; margin-bottom:10px;">
      <label><b>By Students</b></label>
      <div class="student-selector" id="quickAddStudentSelector" style="margin-top:6px;">
        <div class="selected-chips" id="quickAddStudentChips"></div>
        <input type="text" id="quickAddStudentSearch" placeholder="Student Search" autocomplete="off" />
        <div class="selector-results" id="quickAddStudentResults">
          <div class="student-placeholder">Start typing to find a student.</div>
        </div>
      </div>
      <div class="selector-actions">
        <button type="button" id="quickAddClearSearch">Clear search</button>
      </div>
    </div>

    <label><b>Category:</b></label>
    <select id="quickAddCategory" class="white-input" style="width:100%; margin-bottom:10px;">
      <option value="">Select category</option>
      <option value="practice">Practice</option>
      <option value="participation">Participation</option>
      <option value="performance">Performance</option>
      <option value="personal">Personal</option>
      <option value="proficiency">Proficiency</option>
    </select>

    <label><b>Date:</b></label>
    <div style="display:flex; gap:10px; align-items:center; margin-bottom:8px;">
      <input type="date" id="quickAddDate" class="white-input" style="width:100%;" />
      <button type="button" id="quickAddDateBtn" class="blue-button">Add Date</button>
    </div>
    <div class="selected-chips" id="quickAddDateChips" style="margin-bottom:10px;"></div>
    <div style="margin:-6px 0 10px 0; font-size:0.85rem; color:#00477d;">Points entered below will be applied to every selected date.</div>

    <label><b>Points:</b></label>
    <input type="number" id="quickAddPoints" class="white-input" placeholder="Enter points" style="width:100%; margin-bottom:10px;" />

    <label><b>Notes:</b></label>
    <textarea id="quickAddNotes" class="white-input" placeholder="Optional note" style="width:100%; margin-bottom:15px;"></textarea>

    <div style="display:flex; justify-content:center; gap:15px;">
      <button id="quickAddSubmit" class="blue-button">Submit</button>
      <button id="quickAddCancel" class="blue-button" style="background:#999;">Cancel</button>
    </div>
  </div>
</div>

  </main>
  <script type="module" src="config.js"></script>
  <script type="module" src="supabaseClient.js"></script>
  <script type="module" src="authGuard.js"></script>
  <script type="module" src="review-logs.js"></script>
</body>
</html>
