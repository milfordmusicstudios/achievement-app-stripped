<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Studio Settings | Achievement App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="nav.css" />
  <link rel="stylesheet" href="settings-tabs.css" />
  <link rel="stylesheet" href="studio-settings-embed.css" />
</head>
<body class="app-shell app-bg bg-teal settings-page studio-settings-page">
  <div class="app-main">
    <div id="envBadge" class="env-badge" style="display:none;"></div>

    <main class="app">
      <div class="settings-wrap">
        <div id="settings-tabs"></div>
        <div class="settings-page-header">
          <img id="studioLogo" class="studio-logo-header" src="images/logos/logo.png" alt="Studio logo" onerror="this.style.display='none'">
          <h1 class="settings-title">Studio Settings</h1>
        </div>
        <section class="settings-section">

          <div id="studioAccessNotice" class="settings-card studio-access-card" style="display:none;">
            <div class="settings-card-body">
              <p>Studio settings are available to admins only.</p>
            </div>
          </div>

          <div id="studioSections" class="settings-accordion" style="display:none;">
            <div class="accordion-card" data-section="manage-users">
              <button type="button" class="accordion-header" aria-expanded="false">Manage Users</button>
              <div class="accordion-body" hidden>
                <div class="accordion-panel-content">
                  <div class="manage-users-invite">
                    <button
                      id="inviteUserOpenBtn"
                      type="button"
                      class="invite-user-trigger"
                      aria-label="Invite User"
                    >+</button>
                    <span class="invite-user-label">invite User</span>
                  </div>
                  <div id="panel-manage-users" class="panel-root settings-panel-host" data-panel="manage-users"></div>
                </div>
              </div>
            </div>

            <div class="accordion-card" data-section="studio-settings">
              <button type="button" class="accordion-header" aria-expanded="false">Studio Controls</button>
              <div class="accordion-body" hidden>
                <div class="accordion-panel-content">
                  <div class="studio-controls-form">
                    <section class="settings-section">
                      <div class="section-head">
                        <div class="section-title">Studio Identity</div>
                      </div>
                      <div class="settings-rows">
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="studioName">Studio Name</label>
                          </div>
                          <div class="row-value">
                            <input id="studioName" type="text" class="settings-input" placeholder="Studio name" />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="studioEmail">Studio Email</label>
                          </div>
                          <div class="row-value">
                            <input id="studioEmail" type="email" class="settings-input" placeholder="studio@example.com" />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="studioLogoFile">Studio Logo</label>
                          </div>
                        <div class="row-value">
                          <label for="studioLogoFile" class="logo-upload-area">
                            <img id="studioLogoPreview" alt="Studio logo preview" style="display:none;" />
                            <span class="logo-upload-text">Click to replace logo</span>
                          </label>
                          <input id="studioLogoFile" type="file" accept="image/*" hidden />
                        </div>
                          <div></div>
                        </div>
                      </div>
                    </section>

                    <section class="settings-section">
                      <div class="section-head">
                        <div class="section-title">Permissions</div>
                      </div>
                      <div class="settings-rows">
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="teacherCanLogPoints">Teacher can log points</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="teacherCanLogPoints" aria-pressed="false">Disabled</button>
                            <input id="teacherCanLogPoints" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="teacherCanApproveLogs">Teacher can approve logs</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="teacherCanApproveLogs" aria-pressed="false">Disabled</button>
                            <input id="teacherCanApproveLogs" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="teacherCanCreateChallenges">Teacher can create challenges</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="teacherCanCreateChallenges" aria-pressed="false">Disabled</button>
                            <input id="teacherCanCreateChallenges" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row disabled-row" id="challengeApprovalRow">
                          <div class="row-label">
                            <label for="teacherChallengesRequireApproval">Teacher challenges require approval</label>
                            <button type="button" class="hint-toggle" data-hint-target="hint-challenges" aria-expanded="false">?</button>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="teacherChallengesRequireApproval" aria-pressed="false">Disabled</button>
                            <input id="teacherChallengesRequireApproval" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-hint" id="hint-challenges" hidden>
                          When ON, teacher-created challenges require admin approval before going live.
                        </div>
                        <div class="settings-row leaderboard-toggle-row">
                          <div class="row-label">
                            <span>Leaderboard</span>
                            <button type="button" class="hint-toggle" data-hint-target="hint-leaderboard" aria-expanded="false">?</button>
                          </div>
                          <div class="row-value" style="display:flex; flex-wrap:wrap; gap:12px; align-items:center;">
                            <button
                              type="button"
                              class="toggle-button disabled scope-toggle-single"
                              data-scope-toggle
                              aria-pressed="false"
                            >
                              Studio Only
                            </button>
                            <input
                              type="radio"
                              name="leaderboardScope"
                              id="leaderboardStudioOnly"
                              value="studio_only"
                              checked
                              hidden
                            />
                            <input
                              type="radio"
                              name="leaderboardScope"
                              id="leaderboardGlobal"
                              value="global"
                              hidden
                            />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-hint" id="hint-leaderboard" hidden>
                          Global is for future multi-studio mode and toggles a global view option for students.
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="badgesEnabled">Badges</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="badgesEnabled" aria-pressed="false">Disabled</button>
                            <input id="badgesEnabled" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                      </div>
                    </section>

                    <section class="settings-section">
                      <div class="section-head">
                        <div class="section-title">Notifications</div>
                      </div>
                      <div class="settings-rows">
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="adminOnLogSubmitted">Notify on log submitted</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="adminOnLogSubmitted" aria-pressed="false">Disabled</button>
                            <input id="adminOnLogSubmitted" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="adminOnLogFlagged">Notify on log flagged</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="adminOnLogFlagged" aria-pressed="false">Disabled</button>
                            <input id="adminOnLogFlagged" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                        <div class="settings-row">
                          <div class="row-label">
                            <label for="adminOnLevelUp">Notify on level up</label>
                          </div>
                          <div class="row-value toggle-row-value">
                            <button type="button" class="toggle-button disabled" data-toggle-target="adminOnLevelUp" aria-pressed="false">Disabled</button>
                            <input id="adminOnLevelUp" type="checkbox" hidden />
                          </div>
                          <div></div>
                        </div>
                      </div>
                    </section>


                    <div class="settings-actions" style="margin-top:24px;">
                      <button id="saveStudioSettingsBtn" type="button" class="blue-button">Save</button>
                      <div id="studioSettingsStatus" class="settings-hint" aria-live="polite"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="inviteUserModal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true">
            <div class="modal-card">
              <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;">
                <h3 style="margin:0; font-size:20px;">Invite Student/Staff</h3>
                <button
                  id="inviteUserCloseBtn"
                  type="button"
                  aria-label="Close invite modal"
                  style="border:none; background:rgba(11,79,138,0.1); border-radius:10px; padding:4px 10px; font-weight:900; cursor:pointer;"
                >Ã—</button>
              </div>
              <div class="modal-body" style="display:flex; flex-direction:column; gap:12px;">
                <form id="inviteForm" class="settings-form" style="max-width:520px; width:100%;">
                  <div class="embed-row">
                    <div class="embed-label">Email</div>
                    <div class="embed-field">
                      <input id="inviteEmail" type="email" required />
                    </div>
                  </div>
                  <div class="embed-divider"></div>
                  <div class="embed-row">
                    <div class="embed-label">Role</div>
                    <div class="embed-field">
                      <select id="inviteRole" required>
                        <option value="">Select role</option>
                        <option value="student">Student</option>
                        <option value="parent">Parent</option>
                        <option value="teacher">Teacher</option>
                        <option value="admin">Admin</option>
                      </select>
                    </div>
                  </div>
                  <p id="inviteError" style="color:#c62828; display:none; margin-top:10px;"></p>
                  <p id="inviteSuccess" style="color:#0b7a3a; display:none; margin-top:10px;"></p>
                  <div class="embed-actions">
                    <div class="button-row" style="margin-top:14px;">
                      <button type="submit" class="blue-button">Create Invite</button>
                    </div>
                  </div>
                </form>

                <div id="inviteLinkBox" style="display:none; margin-top:16px;">
                  <div style="font-weight:700; margin-bottom:6px;">Invite link</div>
                  <input id="inviteLinkInput" type="text" readonly style="width:100%;" />
                  <button id="copyInviteBtn" class="blue-button" type="button" style="margin-top:8px;">Copy invite link</button>
                </div>

                <h3 class="embed-subhead">Pending Invites</h3>
                <div class="embed-pending">
                  <div style="margin-top:24px;">
                    <div id="pendingInvites" style="display:grid; gap:10px;"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
    <div id="toast" class="toast"></div>
  </div>

  <div id="app-bottom-nav"></div>
  <script src="config.js"></script>
  <script type="module" src="nav.js"></script>
  <script type="module" src="settings-tabs.js"></script>
  <script type="module" src="studio-settings.js"></script>
  <script type="module" src="studio-settings-hub.js"></script>
  <script type="module" src="manage-users.js"></script>
  <script type="module" src="invite-staff.js"></script>
</body>
</html>
